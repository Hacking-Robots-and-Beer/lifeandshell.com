<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Openvpn on Raspberry Pi | Life and Shell</title>
  <link rel = 'canonical' href = 'https://lifeandshell.com/posts/openvpn-on-raspberry-pi/'>
  <meta name="description" content="  Mattias Hemmingsson: Welcome to my private site collecting blog post, Git updates and podcast episodes">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">



 <script async src="https://www.googletagmanager.com/gtag/js?id=G-3SYH00HY9X"></script>
 <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'G-3SYH00HY9X');
 </script>


  <meta property="og:url" content="https://lifeandshell.com/posts/openvpn-on-raspberry-pi/">
  <meta property="og:site_name" content="Life and Shell">
  <meta property="og:title" content="Openvpn on Raspberry Pi">
  <meta property="og:description" content="So sommar is comming and I planning to be away as mutch as possible.
But I need an door in to my server at home for some work. When Im of i only will have an 3g/4g connections so its mutch nicer to work against my server home at a stabel 100 line.
So for making this possibel I install en openvpn server on my PI sitting in my closet.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2013-06-17T08:12:52+00:00">
    <meta property="article:modified_time" content="2013-06-17T08:12:52+00:00">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Security">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Openvpn on Raspberry Pi">
  <meta name="twitter:description" content="So sommar is comming and I planning to be away as mutch as possible.
But I need an door in to my server at home for some work. When Im of i only will have an 3g/4g connections so its mutch nicer to work against my server home at a stabel 100 line.
So for making this possibel I install en openvpn server on my PI sitting in my closet.">

  
  
    
  
  
  <link rel="stylesheet" href="https://lifeandshell.com/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css" integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N&#43;XoIuZg=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://lifeandshell.com/images/favicon.ico" />

  
  
  

</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts/">Writings</a></li>
         
        <li><a href="/tags/">Tags</a></li>
         
        <li><a href="/git/">Git</a></li>
         
        <li><a href="/podcast/">Podcast</a></li>
         
        <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://lifeandshell.com/posts/installing-pfsense-on-clavister/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://lifeandshell.com/posts/install-glassfish4-and-java7-on-centos/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&text=Openvpn%20on%20Raspberry%20Pi" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&is_video=false&description=Openvpn%20on%20Raspberry%20Pi" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Openvpn%20on%20Raspberry%20Pi&body=Check out this article: https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&name=Openvpn%20on%20Raspberry%20Pi&description=So%20sommar%20is%20comming%20and%20I%20planning%20to%20be%20away%20as%20mutch%20as%20possible.%0aBut%20I%20need%20an%20door%20in%20to%20my%20server%20at%20home%20for%20some%20work.%20When%20Im%20of%20i%20only%20will%20have%20an%203g%2f4g%20connections%20so%20its%20mutch%20nicer%20to%20work%20against%20my%20server%20home%20at%20a%20stabel%20100%20line.%0aSo%20for%20making%20this%20possibel%20I%20install%20en%20openvpn%20server%20on%20my%20PI%20sitting%20in%20my%20closet." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&t=Openvpn%20on%20Raspberry%20Pi" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Openvpn on Raspberry Pi
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2013-06-17 08:12:52 &#43;0000 UTC" itemprop="datePublished">2013-06-17</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          2 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/linux">Linux</a>
            
             ,  
            <a class="category-link" href="/categories/security">Security</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/linux" rel="tag">Linux</a>
            
             ,  
            <a class="tag-link" href="/tags/security" rel="tag">Security</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p>So sommar is comming and I planning to be away as mutch as possible.<br />
But I need an door in to my server at home for some work. When Im of i only will have an 3g/4g connections so its mutch nicer to work against my server home at a stabel 100 line.</p>
<p>So for making this possibel I install en openvpn server on my PI sitting in my closet.<br />
THIS CONFIG SEND ALL TRAFFIC TROW THE VPN so be ware ðŸ™‚</p>
<p>Installing Openvpn</p>
<pre><em>apt-get install openvpn openssl</em></pre>
<p>Setting up keys used for vpn</p>
<pre>cd /etc/openvpn
cp -r /usr/share/doc/openvpn/examples/easy-rsa/2.0 ./easy-rs
cd easy-rsa/</pre>
<p>Open the file vars and at the buttom enter your settings</p>
<pre>export KEY_COUNTRY="SE"
export KEY_PROVINCE="ST"
export KEY_CITY="Stockholm"
export KEY_ORG="Elino"
export KEY_EMAIL="matte@elino.se"
export KEY_EMAIL=matte@elino.se
export KEY_CN=elino.no-ip.org
export KEY_NAME=mepi
export KEY_OU=mepi
export PKCS11_MODULE_PATH=changeme
export PKCS11_PIN=1234</pre>
<p>make new synlink to config file</p>
<pre>ln -s openssl-1.0.0.cnf openssl.cnf</pre>
<p>Ok ready to make som certs first load and clean all certs (Onlye clean the first time you will delete all certs)</p>
<pre>source vars
./clean-all</pre>
<pre>./build-ca openvpn
<em>./build-key-server server
</em><em>./build-dh
</em>openvpn --genkey --secret ta.key</pre>
<p>Installing the certs</p>
<pre>cp keyscp server.crt server.key ca.crt ../ta.key dh1024.pem /etc/openvpn/</pre>
<p>Set up the openvpn config</p>
<p>make the file /etc/openvpn/server.conf and past the following into the file</p>
<pre>dev tun
proto udp
port 1194
ca /etc/openvpn/ca.crt
cert /etc/openvpn/server.crt
key /etc/openvpn/server.key
dh /etc/openvpn/dh1024.pem
user nobody
tls-auth ta.key 0
group nogroup
server 10.8.0.0 255.255.255.0
persist-key
persist-tun
status /var/log/openvpn-status.log
verb 3
client-to-client
push "redirect-gateway def1"
#set the dns servers
push "dhcp-option DNS 8.8.8.8"
push "dhcp-option DNS 8.8.4.4"
log-append /var/log/openvpn
comp-lzo</pre>
<p>Restart the vpn server</p>
<pre>/etc/init./openvpn restart</pre>
<p>look in the logfile (/var/log/openvpn) to se that the server started and do a ifconfig to make shoure you have a tun device.</p>
<p>Now we must enabled traffic forwarding.</p>
<pre>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</pre>
<pre>iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j SNAT --to [ipadres rpi]</pre>
<pre></pre>
<p>Make shoure this command is run if you restart your pi.</p>
<h2>Making some clients to the server</h2>
<p>First lets make som certs to use.</p>
<pre>cd /etc/openvpn/easy-rsa/
 source vars
 ./build-key mahe</pre>
<p>Copy the certs needed</p>
<pre>mkdir /etc/openvpn/clients
mkdir /etc/openvpn/clients/mahe
cd keys
cp mahe.crt mahe.key ca.crt ../ta.key /etc/openvpn/clients/mahe/</pre>
<p>make an client config file nane /etc/openvpn/cleints/mahe/client.con (if used on windows call the file client.ovpn)</p>
<pre>dev tun
client
proto udp
remote YOUR.RASPBERRYPI.IPADRESS 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
cert mahe.crt
key mahe.key
tls-auth ta.key 1
comp-lzo
verb 3</pre>
<p>Now you can copy the mahe folder to you laptop and for connection run from teh mahe folder. It you make new certs and called them user you must update this hoe to and config to use the correct certs.</p>
<pre>sudo openvpn --config client.conf</pre>
<p>&nbsp;</p>
<p>Make shoure you have udp port 1194 open in you firewall to your raspberry pi.</p>
<p>&nbsp;</p>
<p>When you see this line in the openvpn client you are connected.</p>
<pre>Initialization Sequence Completed</pre>
<p>And now you are routing all you traffic trow the Raspberry Pi</p>
<p>Go toÂ <a href="http://ip-lookup.net/">http://ip-lookup.net/</a>Â and se what public ip you are using.</p>
<p>&nbsp;</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts/">Writings</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/git/">Git</a></li>
         
          <li><a href="/podcast/">Podcast</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&text=Openvpn%20on%20Raspberry%20Pi" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&is_video=false&description=Openvpn%20on%20Raspberry%20Pi" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Openvpn%20on%20Raspberry%20Pi&body=Check out this article: https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&title=Openvpn%20on%20Raspberry%20Pi" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&name=Openvpn%20on%20Raspberry%20Pi&description=So%20sommar%20is%20comming%20and%20I%20planning%20to%20be%20away%20as%20mutch%20as%20possible.%0aBut%20I%20need%20an%20door%20in%20to%20my%20server%20at%20home%20for%20some%20work.%20When%20Im%20of%20i%20only%20will%20have%20an%203g%2f4g%20connections%20so%20its%20mutch%20nicer%20to%20work%20against%20my%20server%20home%20at%20a%20stabel%20100%20line.%0aSo%20for%20making%20this%20possibel%20I%20install%20en%20openvpn%20server%20on%20my%20PI%20sitting%20in%20my%20closet." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flifeandshell.com%2fposts%2fopenvpn-on-raspberry-pi%2f&t=Openvpn%20on%20Raspberry%20Pi" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2026  Mattias Hemmingssion <a href="mailto:mattias@lifeandshell.com">mattias@lifeandshell.com</a> 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts/">Writings</a></li>
         
        <li><a href="/tags/">Tags</a></li>
         
        <li><a href="/git/">Git</a></li>
         
        <li><a href="/podcast/">Podcast</a></li>
         
        <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
