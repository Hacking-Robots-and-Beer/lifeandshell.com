<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Running Wazuh Agents in Docker – From Traditional HIDS to Ingest Agents | Life and Shell</title>
  <link rel = 'canonical' href = 'https://lifeandshell.com/posts/wa/'>
  <meta name="description" content="  Mattias Hemmingsson: Welcome to my private site collecting blog post, Git updates and podcast episodes">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">



 <script async src="https://www.googletagmanager.com/gtag/js?id=G-3SYH00HY9X"></script>
 <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'G-3SYH00HY9X');
 </script>


  <meta property="og:url" content="https://lifeandshell.com/posts/wa/">
  <meta property="og:site_name" content="Life and Shell">
  <meta property="og:title" content="Running Wazuh Agents in Docker – From Traditional HIDS to Ingest Agents">
  <meta property="og:description" content="Wazuh Wazuh is a powerful open-source security platform built to monitor systems for threats, intrusions, and anomalies. Traditionally, the Wazuh agent is installed on physical or virtual Linux servers to perform host-based intrusion detection (HIDS). It passively monitors the system and reports any suspicious changes or activity to the Wazuh manager.
This works well in environments where systems are treated as immutable infrastructure — where servers are expected to remain unchanged.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-13T08:56:12+00:00">
    <meta property="article:modified_time" content="2025-04-13T08:56:12+00:00">
    <meta property="article:tag" content="K8s">
    <meta property="article:tag" content="Life">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Security">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Running Wazuh Agents in Docker – From Traditional HIDS to Ingest Agents">
  <meta name="twitter:description" content="Wazuh Wazuh is a powerful open-source security platform built to monitor systems for threats, intrusions, and anomalies. Traditionally, the Wazuh agent is installed on physical or virtual Linux servers to perform host-based intrusion detection (HIDS). It passively monitors the system and reports any suspicious changes or activity to the Wazuh manager.
This works well in environments where systems are treated as immutable infrastructure — where servers are expected to remain unchanged.">

  
  
    
  
  
  <link rel="stylesheet" href="https://lifeandshell.com/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css" integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N&#43;XoIuZg=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://lifeandshell.com/images/favicon.ico" />

  
  
  

</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts/">Writings</a></li>
         
        <li><a href="/tags/">Tags</a></li>
         
        <li><a href="/git/">Git</a></li>
         
        <li><a href="/podcast/">Podcast</a></li>
         
        <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://lifeandshell.com/posts/wazuh-on-kubernetes-using-helm/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://lifeandshell.com/posts/wazuh-digest-any-source/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&text=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&is_video=false&description=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents&body=Check out this article: https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&name=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents&description=Wazuh%20Wazuh%20is%20a%20powerful%20open-source%20security%20platform%20built%20to%20monitor%20systems%20for%20threats%2c%20intrusions%2c%20and%20anomalies.%20Traditionally%2c%20the%20Wazuh%20agent%20is%20installed%20on%20physical%20or%20virtual%20Linux%20servers%20to%20perform%20host-based%20intrusion%20detection%20%28HIDS%29.%20It%20passively%20monitors%20the%20system%20and%20reports%20any%20suspicious%20changes%20or%20activity%20to%20the%20Wazuh%20manager.%0aThis%20works%20well%20in%20environments%20where%20systems%20are%20treated%20as%20immutable%20infrastructure%20%e2%80%94%20where%20servers%20are%20expected%20to%20remain%20unchanged." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&t=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Running Wazuh Agents in Docker – From Traditional HIDS to Ingest Agents
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2025-04-13 08:56:12 &#43;0000 UTC" itemprop="datePublished">2025-04-13</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          2 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/k8s">k8s</a>
            
             ,  
            <a class="category-link" href="/categories/life">Life</a>
            
             ,  
            <a class="category-link" href="/categories/linux">Linux</a>
            
             ,  
            <a class="category-link" href="/categories/security">Security</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/k8s" rel="tag">k8s</a>
            
             ,  
            <a class="tag-link" href="/tags/life" rel="tag">Life</a>
            
             ,  
            <a class="tag-link" href="/tags/linux" rel="tag">Linux</a>
            
             ,  
            <a class="tag-link" href="/tags/security" rel="tag">Security</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      
<p></p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Wazuh</h2>



<p><strong>Wazuh</strong> is a powerful open-source security platform built to monitor systems for threats, intrusions, and anomalies. Traditionally, the Wazuh agent is installed on physical or virtual Linux servers to perform host-based intrusion detection (HIDS). It passively monitors the system and reports any suspicious changes or activity to the Wazuh manager.</p>



<p>This works well in environments where systems are treated as immutable infrastructure — where servers are expected to remain unchanged. Any deviation from the expected system state triggers an alert, which aligns perfectly with the Wazuh philosophy.</p>



<p>However, the landscape of modern infrastructure has evolved.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">The Challenge: Pets vs. Cattle</h2>



<p>In today’s cloud-native environments, we often treat our servers like &#8220;cattle&#8221; instead of &#8220;pets&#8221; — frequently spinning them up and down, running applications in short-lived containers or pods. This approach poses a challenge to traditional Wazuh agents, which expect a consistent, long-lived system state.</p>



<p>As of now, Wazuh doesn&#8217;t officially provide a Docker-native agent, making it a bit tricky to integrate into containerized environments — until now.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Introducing: Dockerized Wazuh Agents</h2>



<p>Since I run nearly all of my infrastructure in containers, I needed a Wazuh agent that could integrate seamlessly into my Docker and Kubernetes environments. So I built one.</p>



<p>My Dockerized Wazuh agent is designed to provision itself against the Wazuh manager automatically. This means you can drop it into any Docker Compose file or Kubernetes deployment and have it running in minutes across multiple servers or clusters.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Not Just a HIDS – Using Wazuh as an Ingest Agent</h2>



<p>Instead of using the agent to monitor the filesystem directly (which is still possible via mounted volumes), I’ve repurposed it into an <strong>ingest agent</strong>.</p>



<h3 class="wp-block-heading">What does this mean?</h3>



<p>I’ve added a lightweight API script to the agent container, allowing it to receive logs in JSON format from external services. These logs are then forwarded to the Wazuh manager for analysis and alerting.</p>



<p>This setup allows you to:</p>



<ul class="wp-block-list">
<li>Centralize log ingestion from any service that can send JSON logs.</li>



<li>Use Wazuh’s alerting engine without tying the agent to a specific system or container lifecycle.</li>



<li>Seamlessly integrate with Docker- or Kubernetes-based workflows.</li>
</ul>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Why This Matters</h2>



<p>Running Wazuh in Docker opens up several possibilities:</p>



<ul class="wp-block-list">
<li><strong>Portable and repeatable deployments</strong>: Add the agent to your stack via Docker Compose or Helm charts.</li>



<li><strong>Scalability</strong>: Deploy across nodes without manually configuring each one.</li>



<li><strong>Flexibility</strong>: Use the agent as a log forwarder or traditional HIDS agent, depending on your needs.</li>
</ul>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Try It Yourself</h2>



<p>The Dockerized Wazuh agent, including the ingest API, is available on GitHub:</p>



<p><a href="https://github.com/samma-io/wazuh-agent">https://github.com/samma-io/wazuh-agent</a></p>



<p>Feel free to fork it, use it, and adapt it to your infrastructure.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Final Thoughts</h2>



<p>Using Wazuh as a containerized ingest agent is a modern, flexible way to extend your security monitoring. Whether you’re running a Kubernetes cluster or a few Docker-based services on edge nodes, this approach simplifies deployment and broadens what Wazuh can monitor.</p>



<p>Security should scale with your infrastructure — and now, with Wazuh in Docker, it can.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p></p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts/">Writings</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/git/">Git</a></li>
         
          <li><a href="/podcast/">Podcast</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&text=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&is_video=false&description=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents&body=Check out this article: https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&title=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&name=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents&description=Wazuh%20Wazuh%20is%20a%20powerful%20open-source%20security%20platform%20built%20to%20monitor%20systems%20for%20threats%2c%20intrusions%2c%20and%20anomalies.%20Traditionally%2c%20the%20Wazuh%20agent%20is%20installed%20on%20physical%20or%20virtual%20Linux%20servers%20to%20perform%20host-based%20intrusion%20detection%20%28HIDS%29.%20It%20passively%20monitors%20the%20system%20and%20reports%20any%20suspicious%20changes%20or%20activity%20to%20the%20Wazuh%20manager.%0aThis%20works%20well%20in%20environments%20where%20systems%20are%20treated%20as%20immutable%20infrastructure%20%e2%80%94%20where%20servers%20are%20expected%20to%20remain%20unchanged." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flifeandshell.com%2fposts%2fwa%2f&t=Running%20Wazuh%20Agents%20in%20Docker%20%e2%80%93%20From%20Traditional%20HIDS%20to%20Ingest%20Agents" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2026  Mattias Hemmingssion <a href="mailto:mattias@lifeandshell.com">mattias@lifeandshell.com</a> 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts/">Writings</a></li>
         
        <li><a href="/tags/">Tags</a></li>
         
        <li><a href="/git/">Git</a></li>
         
        <li><a href="/podcast/">Podcast</a></li>
         
        <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
